From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: NeumimTo <chleba48@gmail.com>
Date: Wed, 28 Oct 2020 10:54:25 +0100
Subject: [PATCH] Raytrace entities within collection


diff --git a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
index 299f57ca2a65887a0d7e7c584fc1bd5c783b0db2..f6fe354948f7aa6fdfa22c6bcb20818c7d768961 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
@@ -1304,6 +1304,11 @@ public class CraftWorld implements World {
         BoundingBox aabb = BoundingBox.of(startPos, startPos).expandDirectional(dir).expand(raySize);
         Collection<Entity> entities = this.getNearbyEntities(aabb, filter);
 
+        return rayTraceEntities(direction, maxDistance, raySize, startPos, entities);
+    }
+
+    @Override
+    public RayTraceResult rayTraceEntities(Vector direction, double maxDistance, double raySize, Vector startPos, Collection<Entity> entities) {
         Entity nearestHitEntity = null;
         RayTraceResult nearestHitResult = null;
         double nearestDistanceSq = Double.MAX_VALUE;
@@ -1326,6 +1331,7 @@ public class CraftWorld implements World {
         return (nearestHitEntity == null) ? null : new RayTraceResult(nearestHitResult.getHitPosition(), nearestHitEntity, nearestHitResult.getHitBlockFace());
     }
 
+
     @Override
     public RayTraceResult rayTraceBlocks(Location start, Vector direction, double maxDistance) {
         return this.rayTraceBlocks(start, direction, maxDistance, FluidCollisionMode.NEVER, false);
