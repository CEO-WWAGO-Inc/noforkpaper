From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: DaRacci <racci@racci.dev>
Date: Sat, 28 May 2022 23:44:17 +1000
Subject: [PATCH] implement real multiplication operation


diff --git a/src/main/java/net/minecraft/world/entity/ai/attributes/AttributeInstance.java b/src/main/java/net/minecraft/world/entity/ai/attributes/AttributeInstance.java
index 9c58d1190377ca887aa703cb8a96a2b028b63af1..c57578d3b8f66ed1bf355939c6a9340b9ec7ebcc 100644
--- a/src/main/java/net/minecraft/world/entity/ai/attributes/AttributeInstance.java
+++ b/src/main/java/net/minecraft/world/entity/ai/attributes/AttributeInstance.java
@@ -147,7 +147,11 @@ public class AttributeInstance {
         for(AttributeModifier attributeModifier3 : this.getModifiersOrEmpty(AttributeModifier.Operation.MULTIPLY_TOTAL)) {
             e *= 1.0D + attributeModifier3.getAmount();
         }
-
+        // Paper start - implement proper multiplication operation
+        for(AttributeModifier attributeModifier4 : this.getModifiersOrEmpty(AttributeModifier.Operation.MULTIPLY_TOTAL_REAL)) {
+            e *= attributeModifier4.getAmount();
+        }
+        // Paper end
         return this.attribute.sanitizeValue(e);
     }
 
diff --git a/src/main/java/net/minecraft/world/entity/ai/attributes/AttributeModifier.java b/src/main/java/net/minecraft/world/entity/ai/attributes/AttributeModifier.java
index 09b8fa2cee63e6bcb92ffc3694f67d0f90a3805d..e1a6f0a8858f9d276908d9e2b00b6ce804cbfb52 100644
--- a/src/main/java/net/minecraft/world/entity/ai/attributes/AttributeModifier.java
+++ b/src/main/java/net/minecraft/world/entity/ai/attributes/AttributeModifier.java
@@ -2,6 +2,7 @@ package net.minecraft.world.entity.ai.attributes;
 
 import com.mojang.logging.LogUtils;
 import io.netty.util.internal.ThreadLocalRandom;
+import java.awt.print.Paper;
 import java.util.Objects;
 import java.util.UUID;
 import java.util.function.Supplier;
@@ -98,9 +99,11 @@ public class AttributeModifier {
     public static enum Operation {
         ADDITION(0),
         MULTIPLY_BASE(1),
-        MULTIPLY_TOTAL(2);
+        MULTIPLY_TOTAL(2),
+        MULTIPLY_TOTAL_REAL(100); // Paper - implement proper multiplication operation
 
         private static final AttributeModifier.Operation[] OPERATIONS = new AttributeModifier.Operation[]{ADDITION, MULTIPLY_BASE, MULTIPLY_TOTAL};
+        // Paper end
         private final int value;
 
         private Operation(int id) {
@@ -114,6 +117,10 @@ public class AttributeModifier {
         public static AttributeModifier.Operation fromValue(int id) {
             if (id >= 0 && id < OPERATIONS.length) {
                 return OPERATIONS[id];
+            // Paper start
+            } else if (id == 100) {
+                return MULTIPLY_TOTAL_REAL;
+            // Paper end
             } else {
                 throw new IllegalArgumentException("No operation with value " + id);
             }
