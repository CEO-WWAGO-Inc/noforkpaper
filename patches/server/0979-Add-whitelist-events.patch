From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: SageSphinx63920 <sage@sagesphinx63920.dev>
Date: Sun, 14 May 2023 12:57:15 +0200
Subject: [PATCH] Add whitelist events


diff --git a/src/main/java/net/minecraft/server/players/UserWhiteList.java b/src/main/java/net/minecraft/server/players/UserWhiteList.java
index a6c70decad1a496595944a5dd2aeeb387757fef3..f97fda57c84d52ea1c6e9485f289cfb0b16e46da 100644
--- a/src/main/java/net/minecraft/server/players/UserWhiteList.java
+++ b/src/main/java/net/minecraft/server/players/UserWhiteList.java
@@ -2,6 +2,8 @@ package net.minecraft.server.players;
 
 import com.google.gson.JsonObject;
 import com.mojang.authlib.GameProfile;
+import io.papermc.paper.event.player.PlayerWhitelistUpdateEvent;
+
 import java.io.File;
 import java.util.Objects;
 
@@ -30,4 +32,20 @@ public class UserWhiteList extends StoredUserList<GameProfile, UserWhiteListEntr
     protected String getKeyForUser(GameProfile gameProfile) {
         return gameProfile.getId().toString();
     }
+
+    // Paper start - Add whitelist events
+    @Override
+    public void add(UserWhiteListEntry entry) {
+        if (!new io.papermc.paper.event.player.PlayerWhitelistUpdateEvent(org.bukkit.Bukkit.createProfile(entry.getUser().getId()), PlayerWhitelistUpdateEvent.WHITELIST_STATUS.ADDED).callEvent()) return;
+
+        super.add(entry);
+    }
+
+    @Override
+    public void remove(GameProfile profile) {
+        if (!new io.papermc.paper.event.player.PlayerWhitelistUpdateEvent(org.bukkit.Bukkit.createProfile(profile.getId()), PlayerWhitelistUpdateEvent.WHITELIST_STATUS.REMOVED).callEvent()) return;
+
+        super.remove(profile);
+    }
+    // Paper end
 }
