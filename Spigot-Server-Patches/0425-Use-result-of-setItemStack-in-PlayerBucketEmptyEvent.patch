From c75146afc87f1c47c4ccab14de486163cf7385aa Mon Sep 17 00:00:00 2001
From: Draycia <lonelyyordle@gmail.com>
Date: Tue, 14 Jan 2020 05:37:05 -0800
Subject: [PATCH] Use result of setItemStack in PlayerBucketEmptyEvent


diff --git a/src/main/java/net/minecraft/server/EntityLiving.java b/src/main/java/net/minecraft/server/EntityLiving.java
index 80219f2d..c8184f94 100644
--- a/src/main/java/net/minecraft/server/EntityLiving.java
+++ b/src/main/java/net/minecraft/server/EntityLiving.java
@@ -1897,6 +1897,7 @@ public abstract class EntityLiving extends Entity {
         }
     }
 
+    public void setItemInHand(EnumHand enumhand, ItemStack itemstack) { this.a(enumhand, itemstack); } // Paper - OBFHELPER
     public void a(EnumHand enumhand, ItemStack itemstack) {
         if (enumhand == EnumHand.MAIN_HAND) {
             this.setSlot(EnumItemSlot.MAINHAND, itemstack);
diff --git a/src/main/java/net/minecraft/server/ItemBucket.java b/src/main/java/net/minecraft/server/ItemBucket.java
index 0ff92aea..168b5e80 100644
--- a/src/main/java/net/minecraft/server/ItemBucket.java
+++ b/src/main/java/net/minecraft/server/ItemBucket.java
@@ -140,6 +140,7 @@ public class ItemBucket extends Item {
                         ((EntityPlayer) entityhuman).getBukkitEntity().updateInventory(); // SPIGOT-4541
                         return false;
                     }
+                    entityhuman.setItemInHand(enumhand, org.bukkit.craftbukkit.inventory.CraftItemStack.asNMSCopy(event.getItemStack())); // Paper - 2651: set item in hand if event isn't cancelled
                 }
                 // CraftBukkit end
                 if (world.worldProvider.isNether() && this.fluidType.a(TagsFluid.WATER)) {
-- 
2.24.0

