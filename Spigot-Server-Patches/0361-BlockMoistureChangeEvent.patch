From e6634c2c0b52bfcc0ed267c551919933f1f37a63 Mon Sep 17 00:00:00 2001
From: BillyGalbreath <Blake.Galbreath@GMail.com>
Date: Thu, 6 Sep 2018 17:19:48 -0500
Subject: [PATCH] BlockMoistureChangeEvent


diff --git a/src/main/java/net/minecraft/server/BlockSoil.java b/src/main/java/net/minecraft/server/BlockSoil.java
index 2406b4656..4e44836fb 100644
--- a/src/main/java/net/minecraft/server/BlockSoil.java
+++ b/src/main/java/net/minecraft/server/BlockSoil.java
@@ -56,12 +56,20 @@ public class BlockSoil extends Block {
 
             if (!a((IWorldReader) world, blockposition) && !world.isRainingAt(blockposition.up())) {
                 if (i > 0) {
-                    world.setTypeAndData(blockposition, (IBlockData) iblockdata.set(BlockSoil.MOISTURE, Integer.valueOf(i - 1)), 2);
+                    // Paper start
+                    com.destroystokyo.paper.event.block.BlockMoistureChangeEvent event = new com.destroystokyo.paper.event.block.BlockMoistureChangeEvent(MCUtil.toBukkitBlock(world, blockposition), i, i - 1);
+                    if (!event.callEvent())
+                    world.setTypeAndData(blockposition, iblockdata.set(BlockSoil.MOISTURE, event.getNewMoisture()), 2);
+                    // Paper end
                 } else if (!a((IBlockAccess) world, blockposition)) {
                     b(iblockdata, world, blockposition);
                 }
             } else if (i < 7) {
-                world.setTypeAndData(blockposition, (IBlockData) iblockdata.set(BlockSoil.MOISTURE, Integer.valueOf(7)), 2);
+                // Paper start
+                com.destroystokyo.paper.event.block.BlockMoistureChangeEvent event = new com.destroystokyo.paper.event.block.BlockMoistureChangeEvent(MCUtil.toBukkitBlock(world, blockposition), i, 7);
+                if (!event.callEvent())
+                world.setTypeAndData(blockposition, iblockdata.set(BlockSoil.MOISTURE, event.getNewMoisture()), 2);
+                // Paper end
             }
 
         }
-- 
2.18.0

