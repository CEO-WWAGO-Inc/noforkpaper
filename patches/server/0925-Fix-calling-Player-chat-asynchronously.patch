From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Jake Potrebic <jake.m.potrebic@gmail.com>
Date: Wed, 6 Jul 2022 21:31:07 -0700
Subject: [PATCH] Fix calling Player#chat asynchronously


diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
index 287520f91e22309e1268be1940e0fafb628980a9..cc862098bf60b4e91ee7c4fe0b3772a2e18d867e 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
@@ -673,7 +673,7 @@ public class CraftPlayer extends CraftHumanEntity implements Player {
     public void chat(String msg) {
         if (this.getHandle().connection == null) return;
 
-        this.getHandle().connection.chat(msg, false);
+        this.getHandle().connection.chat(msg, !Bukkit.isPrimaryThread());
     }
 
     @Override
