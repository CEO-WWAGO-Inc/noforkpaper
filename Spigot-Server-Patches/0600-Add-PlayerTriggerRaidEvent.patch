From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: simpleauthority <jacob@algorithmjunkie.com>
Date: Sat, 14 Nov 2020 21:31:25 +0100
Subject: [PATCH] Add PlayerTriggerRaidEvent


diff --git a/src/main/java/net/minecraft/server/PersistentRaid.java b/src/main/java/net/minecraft/server/PersistentRaid.java
index 826dcf9f7eedc3664d66170b97b2a19552a0dc60..0624e7516a3098417b794abd5c5f5d0221e7f1f4 100644
--- a/src/main/java/net/minecraft/server/PersistentRaid.java
+++ b/src/main/java/net/minecraft/server/PersistentRaid.java
@@ -1,6 +1,7 @@
 package net.minecraft.server;
 
 import com.google.common.collect.Maps;
+import io.papermc.paper.event.player.PlayerTriggerRaidEvent;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
@@ -91,6 +92,13 @@ public class PersistentRaid extends PersistentBase {
                 Raid raid = this.a(entityplayer.getWorldServer(), blockposition2);
                 boolean flag = false;
 
+                // Paper start
+                if (!new PlayerTriggerRaidEvent(entityplayer.getBukkitEntity()).callEvent()) {
+                    entityplayer.removeEffect(MobEffects.BAD_OMEN);
+                    return null;
+                }
+                // Paper end
+
                 if (!raid.isStarted()) {
                     /* CraftBukkit - moved down
                     if (!this.raids.containsKey(raid.getId())) {
