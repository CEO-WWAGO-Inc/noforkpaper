From e17fde5cd775a17b84384ec126ca2a92ba5408b2 Mon Sep 17 00:00:00 2001
From: Jordyn <jordyn@husk.pro>
Date: Thu, 12 Dec 2019 15:06:52 +1100
Subject: [PATCH] Allow chests to be placed with NBT data


diff --git a/src/main/java/net/minecraft/server/ItemStack.java b/src/main/java/net/minecraft/server/ItemStack.java
index 627fa465..df85f9df 100644
--- a/src/main/java/net/minecraft/server/ItemStack.java
+++ b/src/main/java/net/minecraft/server/ItemStack.java
@@ -240,6 +240,7 @@ public final class ItemStack {
                     enuminteractionresult = EnumInteractionResult.FAIL; // cancel placement
                     // PAIL: Remove this when MC-99075 fixed
                     placeEvent.getPlayer().updateInventory();
+                    world.capturedTileEntities.clear(); // Paper - clear out tile entities as chests and such will pop loot
                     // revert back all captured blocks
                     for (BlockState blockstate : blocks) {
                         blockstate.update(true, false);
diff --git a/src/main/java/net/minecraft/server/TileEntityChest.java b/src/main/java/net/minecraft/server/TileEntityChest.java
index c4766f72..b22bd06e 100644
--- a/src/main/java/net/minecraft/server/TileEntityChest.java
+++ b/src/main/java/net/minecraft/server/TileEntityChest.java
@@ -292,7 +292,7 @@ public class TileEntityChest extends TileEntityLootable { // Paper - Remove ITic
     // CraftBukkit start
     @Override
     public boolean isFilteredNBT() {
-        return true;
+        return false; // Paper
     }
     // CraftBukkit end
 }
-- 
2.23.0.windows.1

