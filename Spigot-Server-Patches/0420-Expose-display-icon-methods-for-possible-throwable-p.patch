From 44296c19b54e53152aeb1c52b81ac2104da173e2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jakub=20Zag=C3=B3rski?= <jaqobbdev@gmail.com>
Date: Wed, 25 Sep 2019 04:38:16 +0200
Subject: [PATCH] Expose display icon methods for possible throwable
 projectiles


diff --git a/src/main/java/net/minecraft/server/EntityProjectileThrowable.java b/src/main/java/net/minecraft/server/EntityProjectileThrowable.java
index eaefe02d7..d2410922c 100644
--- a/src/main/java/net/minecraft/server/EntityProjectileThrowable.java
+++ b/src/main/java/net/minecraft/server/EntityProjectileThrowable.java
@@ -18,16 +18,17 @@ public abstract class EntityProjectileThrowable extends EntityProjectile {
 
     public void setItem(ItemStack itemstack) {
         if (itemstack.getItem() != this.i() || itemstack.hasTag()) {
-            this.getDataWatcher().set(EntityProjectileThrowable.e, SystemUtils.a((Object) itemstack.cloneItemStack(), (itemstack1) -> {
+            this.getDataWatcher().set(EntityProjectileThrowable.e, SystemUtils.a(itemstack.cloneItemStack(), (itemstack1) -> { // Paper - decompiler fix
                 itemstack1.setCount(1);
             }));
         }
 
     }
 
+    public Item getDefaultItem() { return i(); } // Paper - OBFHELPER
     protected abstract Item i();
 
-    protected ItemStack getItem() {
+    public ItemStack getItem() { // Paper - protected -> public
         return (ItemStack) this.getDataWatcher().get(EntityProjectileThrowable.e);
     }
 
diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftEgg.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftEgg.java
index 1d0f43038..444908d1b 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftEgg.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftEgg.java
@@ -24,4 +24,20 @@ public class CraftEgg extends CraftProjectile implements Egg {
     public EntityType getType() {
         return EntityType.EGG;
     }
+
+    // Paper start
+    @Override
+    public org.bukkit.inventory.ItemStack getDisplayItem() {
+        return getHandle().getItem().asBukkitCopy();
+    }
+
+    @Override
+    public void setDisplayItem(org.bukkit.inventory.ItemStack displayItem) {
+        if (displayItem == null || displayItem.getType().isEmpty()) {
+            getHandle().setItem(new net.minecraft.server.ItemStack(getHandle().getDefaultItem()));
+            return;
+        }
+        getHandle().setItem(org.bukkit.craftbukkit.inventory.CraftItemStack.asNMSCopy(displayItem));
+    }
+    // Paper end
 }
diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftEnderPearl.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftEnderPearl.java
index 32221ead3..e76c88393 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftEnderPearl.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftEnderPearl.java
@@ -24,4 +24,20 @@ public class CraftEnderPearl extends CraftProjectile implements EnderPearl {
     public EntityType getType() {
         return EntityType.ENDER_PEARL;
     }
+
+    // Paper start
+    @Override
+    public org.bukkit.inventory.ItemStack getDisplayItem() {
+        return getHandle().getItem().asBukkitCopy();
+    }
+
+    @Override
+    public void setDisplayItem(org.bukkit.inventory.ItemStack displayItem) {
+        if (displayItem == null || displayItem.getType().isEmpty()) {
+            getHandle().setItem(new net.minecraft.server.ItemStack(getHandle().getDefaultItem()));
+            return;
+        }
+        getHandle().setItem(org.bukkit.craftbukkit.inventory.CraftItemStack.asNMSCopy(displayItem));
+    }
+    // Paper end
 }
diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftSnowball.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftSnowball.java
index 222977d79..0ba96f751 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftSnowball.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftSnowball.java
@@ -24,4 +24,20 @@ public class CraftSnowball extends CraftProjectile implements Snowball {
     public EntityType getType() {
         return EntityType.SNOWBALL;
     }
+
+    // Paper start
+    @Override
+    public org.bukkit.inventory.ItemStack getDisplayItem() {
+        return getHandle().getItem().asBukkitCopy();
+    }
+
+    @Override
+    public void setDisplayItem(org.bukkit.inventory.ItemStack displayItem) {
+        if (displayItem == null || displayItem.getType().isEmpty()) {
+            getHandle().setItem(new net.minecraft.server.ItemStack(getHandle().getDefaultItem()));
+            return;
+        }
+        getHandle().setItem(org.bukkit.craftbukkit.inventory.CraftItemStack.asNMSCopy(displayItem));
+    }
+    // Paper end
 }
diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftThrownExpBottle.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftThrownExpBottle.java
index 338bc530c..e5cc8db69 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftThrownExpBottle.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftThrownExpBottle.java
@@ -24,4 +24,20 @@ public class CraftThrownExpBottle extends CraftProjectile implements ThrownExpBo
     public EntityType getType() {
         return EntityType.THROWN_EXP_BOTTLE;
     }
+
+    // Paper start
+    @Override
+    public org.bukkit.inventory.ItemStack getDisplayItem() {
+        return getHandle().getItem().asBukkitCopy();
+    }
+
+    @Override
+    public void setDisplayItem(org.bukkit.inventory.ItemStack displayItem) {
+        if (displayItem == null || displayItem.getType().isEmpty()) {
+            getHandle().setItem(new net.minecraft.server.ItemStack(getHandle().getDefaultItem()));
+            return;
+        }
+        getHandle().setItem(org.bukkit.craftbukkit.inventory.CraftItemStack.asNMSCopy(displayItem));
+    }
+    // Paper end
 }
-- 
2.23.0.windows.1

