From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: booky10 <boooky10@gmail.com>
Date: Sun, 29 Jan 2023 01:38:41 +0100
Subject: [PATCH] Add consumer parameter for spawning falling blocks


diff --git a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
index 0e670de77a7f9926e295e1dd63d909bed1a959ca..d33875ba1ed7422a85b8e388b1f764baf5cfa1ec 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
@@ -1427,6 +1427,13 @@ public class CraftWorld extends CraftRegionAccessor implements World {
 
     @Override
     public FallingBlock spawnFallingBlock(Location location, BlockData data) throws IllegalArgumentException {
+        // Paper start
+        return this.spawnFallingBlock(location, data, null);
+    }
+
+    @Override
+    public FallingBlock spawnFallingBlock(Location location, BlockData data, Consumer<FallingBlock> function) throws IllegalArgumentException {
+        // Paper end
         Preconditions.checkArgument(location != null, "Location cannot be null");
         Preconditions.checkArgument(data != null, "BlockData cannot be null");
 
@@ -1434,6 +1441,12 @@ public class CraftWorld extends CraftRegionAccessor implements World {
         FallingBlockEntity entity = new FallingBlockEntity(this.world, location.getX(), location.getY(), location.getZ(), ((CraftBlockData) data).getState());
         entity.time = 1;
 
+        // Paper start
+        if (function != null) {
+            function.accept((FallingBlock) entity.getBukkitEntity());
+        }
+        // Paper end
+
         this.world.addFreshEntity(entity, SpawnReason.CUSTOM);
         // Paper end
         return (FallingBlock) entity.getBukkitEntity();
