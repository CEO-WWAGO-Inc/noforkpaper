From 53c9b15af751b1ac22eabdf84d92b1fb0e921a78 Mon Sep 17 00:00:00 2001
From: Derek Williams <MrFrydae@gmail.com>
Date: Sat, 10 Aug 2019 16:14:28 -0400
Subject: [PATCH] Revert Block Change Packet API


diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
index e920545df..baf79b0ba 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
@@ -651,6 +651,19 @@ public class CraftPlayer extends CraftHumanEntity implements Player {
         getHandle().playerConnection.sendPacket(packet);
     }
 
+    // Paper start
+    @Override
+    public void revertBlockChange(Location loc) {
+        if (getHandle().playerConnection == null) return;
+        BlockData block = loc.getBlock().getBlockData();
+
+        PacketPlayOutBlockChange packet = new PacketPlayOutBlockChange(((CraftWorld) loc.getWorld()).getHandle(), new BlockPosition(loc.getBlockX(), loc.getBlockY(), loc.getBlockZ()));
+
+        packet.block = ((CraftBlockData) block).getState();
+        getHandle().playerConnection.sendPacket(packet);
+    }
+    // Paper end
+
     @Override
     public void sendSignChange(Location loc, String[] lines) {
        sendSignChange(loc, lines, DyeColor.BLACK);
-- 
2.20.1 (Apple Git-117)

