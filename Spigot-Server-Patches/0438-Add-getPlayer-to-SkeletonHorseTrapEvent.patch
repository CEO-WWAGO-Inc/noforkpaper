From db0d2b16b089c6f982ea5657bf2dc9688d339d06 Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <blake.galbreath@gmail.com>
Date: Sat, 13 Apr 2019 17:46:43 -0500
Subject: [PATCH] Add getPlayer to SkeletonHorseTrapEvent


diff --git a/src/main/java/net/minecraft/server/PathfinderGoalHorseTrap.java b/src/main/java/net/minecraft/server/PathfinderGoalHorseTrap.java
index 887e4461f..52c107722 100644
--- a/src/main/java/net/minecraft/server/PathfinderGoalHorseTrap.java
+++ b/src/main/java/net/minecraft/server/PathfinderGoalHorseTrap.java
@@ -3,17 +3,18 @@ package net.minecraft.server;
 public class PathfinderGoalHorseTrap extends PathfinderGoal {
 
     private final EntityHorseSkeleton a;
+    private EntityHuman player; // Paper
 
     public PathfinderGoalHorseTrap(EntityHorseSkeleton entityhorseskeleton) {
         this.a = entityhorseskeleton;
     }
 
     public boolean a() {
-        return this.a.world.isPlayerNearby(this.a.locX, this.a.locY, this.a.locZ, 10.0D);
+        return (player = a.world.findNearbyPlayer(a, 10D)) != null; // Paper
     }
 
     public void e() {
-        if (!new com.destroystokyo.paper.event.entity.SkeletonHorseTrapEvent((org.bukkit.entity.SkeletonHorse) this.a.getBukkitEntity()).callEvent()) return; // Paper
+        if (!new com.destroystokyo.paper.event.entity.SkeletonHorseTrapEvent((org.bukkit.entity.SkeletonHorse) this.a.getBukkitEntity(), (org.bukkit.entity.Player) player.getBukkitEntity()).callEvent()) return; // Paper
         DifficultyDamageScaler difficultydamagescaler = this.a.world.getDamageScaler(new BlockPosition(this.a));
 
         this.a.s(false);
-- 
2.20.1

