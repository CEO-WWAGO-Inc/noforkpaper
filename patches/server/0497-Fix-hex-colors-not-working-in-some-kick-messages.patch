From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: JRoy <joshroy126@gmail.com>
Date: Thu, 27 Aug 2020 16:57:25 -0400
Subject: [PATCH] Fix hex colors not working in some kick messages


diff --git a/src/main/java/net/minecraft/server/network/ServerLoginPacketListenerImpl.java b/src/main/java/net/minecraft/server/network/ServerLoginPacketListenerImpl.java
index b8541725c46733e5bcb297c920659f7c23c24bb7..2a8cc7cf83eeb8b4018a7c5ba6f4eb2d7683f33c 100644
--- a/src/main/java/net/minecraft/server/network/ServerLoginPacketListenerImpl.java
+++ b/src/main/java/net/minecraft/server/network/ServerLoginPacketListenerImpl.java
@@ -102,14 +102,7 @@ public class ServerLoginPacketListenerImpl implements ServerLoginPacketListener
     // CraftBukkit start
     @Deprecated
     public void disconnect(String s) {
-        try {
-            Component ichatbasecomponent = new TextComponent(s);
-            ServerLoginPacketListenerImpl.LOGGER.info("Disconnecting {}: {}", this.getUserName(), s);
-            this.connection.send(new ClientboundLoginDisconnectPacket(ichatbasecomponent));
-            this.connection.disconnect(ichatbasecomponent);
-        } catch (Exception exception) {
-            ServerLoginPacketListenerImpl.LOGGER.error("Error whilst disconnecting player", exception);
-        }
+        disconnect(org.bukkit.craftbukkit.util.CraftChatMessage.fromString(s, true)[0]); // Paper - Fix hex colors not working in some kick messages
     }
     // CraftBukkit end
 
