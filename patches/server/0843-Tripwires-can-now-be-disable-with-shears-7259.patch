From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: zJanny <48256174+zJanny@users.noreply.github.com>
Date: Sun, 2 Jan 2022 19:20:36 +0100
Subject: [PATCH] Tripwires can now be disable with shears #7259


diff --git a/src/main/java/net/minecraft/world/level/block/TripWireBlock.java b/src/main/java/net/minecraft/world/level/block/TripWireBlock.java
index 335129abd06086d128f803bb488672b35f357389..eda578574503ed21da4fb722c343d16a7640b0ee 100644
--- a/src/main/java/net/minecraft/world/level/block/TripWireBlock.java
+++ b/src/main/java/net/minecraft/world/level/block/TripWireBlock.java
@@ -23,6 +23,9 @@ import net.minecraft.world.level.block.state.properties.Property;
 import net.minecraft.world.level.gameevent.GameEvent;
 import net.minecraft.world.phys.shapes.CollisionContext;
 import net.minecraft.world.phys.shapes.VoxelShape;
+import net.minecraft.world.level.block.entity.BlockEntity;
+import net.minecraft.world.item.ItemStack;
+import javax.annotation.Nullable;
 import org.bukkit.event.entity.EntityInteractEvent; // CraftBukkit
 
 public class TripWireBlock extends Block {
@@ -78,15 +81,17 @@ public class TripWireBlock extends Block {
         }
     }
 
+    //Paper start
     @Override
-    public void playerWillDestroy(Level world, BlockPos pos, BlockState state, Player player) {
+    public void playerDestroy(Level world, Player player, BlockPos pos, BlockState state, @Nullable BlockEntity blockEntity, ItemStack stack) {
         if (!world.isClientSide && !player.getMainHandItem().isEmpty() && player.getMainHandItem().is(Items.SHEARS)) {
             world.setBlock(pos, (BlockState) state.setValue(TripWireBlock.DISARMED, true), 4);
             world.gameEvent(player, GameEvent.SHEAR, pos);
+            return;
         }
-
-        super.playerWillDestroy(world, pos, state, player);
+        super.playerDestroy(world, player, pos, state, blockEntity, stack);
     }
+    //Paper end
 
     private void updateSource(Level world, BlockPos pos, BlockState state) {
         // Paper start - fix state inconsistency
@@ -133,7 +138,7 @@ public class TripWireBlock extends Block {
     public void entityInside(BlockState state, Level world, BlockPos pos, Entity entity) {
         if (!new io.papermc.paper.event.entity.EntityInsideBlockEvent(entity.getBukkitEntity(), org.bukkit.craftbukkit.block.CraftBlock.at(world, pos)).callEvent()) { return; } // Paper
         if (!world.isClientSide) {
-            if (!(Boolean) state.getValue(TripWireBlock.POWERED)) {
+            if (!(Boolean) state.getValue(TripWireBlock.POWERED) && !(Boolean)state.getValue(TripWireBlock.DISARMED)) { //Paper
                 this.checkPressed(world, pos);
             }
         }
