From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: XanderWander <xander.dekeijzer@student.hu.nl>
Date: Wed, 15 Mar 2023 18:09:20 +0100
Subject: [PATCH] Fix changeGameModeForPlayer to use gameModeForPlayer instead
 of previousGameModeForPlayer as the new previousGameModeForPlayer


diff --git a/src/main/java/net/minecraft/server/level/ServerPlayerGameMode.java b/src/main/java/net/minecraft/server/level/ServerPlayerGameMode.java
index 58b093bb1de78ee3b3b2ea364aa50474883f443a..2be2f87454fc6acaa3ca9f67f869f7ac76afc751 100644
--- a/src/main/java/net/minecraft/server/level/ServerPlayerGameMode.java
+++ b/src/main/java/net/minecraft/server/level/ServerPlayerGameMode.java
@@ -91,7 +91,7 @@ public class ServerPlayerGameMode {
                 return event; // Paper
             }
             // CraftBukkit end
-            this.setGameModeForPlayer(gameMode, this.previousGameModeForPlayer);
+            this.setGameModeForPlayer(gameMode, this.gameModeForPlayer);
             this.player.onUpdateAbilities();
             this.player.server.getPlayerList().broadcastAll(new ClientboundPlayerInfoUpdatePacket(ClientboundPlayerInfoUpdatePacket.Action.UPDATE_GAME_MODE, this.player), this.player); // CraftBukkit
             this.level.updateSleepingPlayerList();
