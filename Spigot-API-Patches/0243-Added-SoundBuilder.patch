From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Fruxz <cedricspitzer@outlook.de>
Date: Fri, 18 Dec 2020 01:02:39 +0100
Subject: [PATCH] Added SoundBuilder


diff --git a/src/main/java/io/papermc/paper/sound/SoundBuilder.java b/src/main/java/io/papermc/paper/sound/SoundBuilder.java
new file mode 100644
index 0000000000000000000000000000000000000000..d257f339694c833ed63042bd64b0b740fa51caed
--- /dev/null
+++ b/src/main/java/io/papermc/paper/sound/SoundBuilder.java
@@ -0,0 +1,225 @@
+package io.papermc.paper.sound;
+
+import org.bukkit.Location;
+import org.bukkit.Sound;
+import org.bukkit.SoundCategory;
+import org.bukkit.World;
+import org.bukkit.entity.Player;
+import org.jetbrains.annotations.NotNull;
+import org.jetbrains.annotations.Nullable;
+
+import java.util.Collection;
+import java.util.List;
+
+/**
+ * Helps prepare a sound to be sent to players.
+ */
+public interface SoundBuilder {
+
+    /**
+     * Plays the sound to all receiving players (or all). This method is safe to use
+     * Asynchronously
+     *
+     * @return a reference to this object.
+     */
+    SoundBuilder play();
+
+    /**
+     * @return The sound going to be sent
+     */
+    @NotNull
+    Sound sound();
+
+    /**
+     * Changes what sound will be sent
+     *
+     * @param sound The sound
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder sound(@NotNull Sound sound);
+
+    /**
+     * @return The category under which the sound will be played
+     */
+    @Nullable
+    SoundCategory category();
+
+    /**
+     * Changes under which category the sound will be played
+     */
+    @NotNull
+    SoundBuilder category(SoundCategory category);
+
+    /**
+     * @return The volume level of the sound played
+     */
+    @NotNull
+    Float volume();
+
+    /**
+     * Changes the volume level of the sound played
+     *
+     * @param volume The volume
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder volume(@NotNull Float volume);
+
+    /**
+     * @return The pitch of the sound played
+     */
+    @NotNull
+    Float pitch();
+
+    /**
+     * Changes the pitch of the sound played
+     *
+     * @param pitch The pitch
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder pitch(@NotNull Float pitch);
+
+    /**
+     * @return List of players who will receive the sound, or null for all in world
+     */
+    @Nullable
+    List<Player> receivers();
+
+    /**
+     * Example use:
+     *
+     * builder.receivers(16)
+     *
+     * @return If this sound is going to be sent to someone
+     */
+    boolean hasReceivers();
+
+    /**
+     * Sends this sound to all players in the world. This is rather silly and you should likely not
+     * be doing this.
+     *
+     * Just be a logical person and use receivers by radius or collection.
+     *
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder allPlayers();
+
+    /**
+     * @param receivers List of players to receive this sound, or null for all players in the
+     * world
+     * @return a reference to this object.
+     * @deprecated The use of list's is not appreciated
+     */
+    @NotNull
+    @Deprecated
+    SoundBuilder receivers(@Nullable List<Player> receivers);
+
+    /**
+     * @param receivers List of players to receive this sound, or null for all players in the
+     * world
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder receivers(@Nullable Collection<Player> receivers);
+
+    /**
+     * @param receivers List of players to be receive this sound, or null for all players in the
+     * world
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder receivers(@Nullable Player... receivers);
+
+    /**
+     * Selects all players within a cuboid selection around the sound location, within the
+     * specified bounding box. If you want a more spherical check, see {@link #receivers(int,
+     * boolean)}
+     *
+     * @param radius amount to add on all axis
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder receivers(int radius);
+
+    /**
+     * Selects all players within the specified radius around the sound location. If byDistance is
+     * false, behavior uses cuboid selection the same as {@link #receivers(int, int)} If byDistance is
+     * true, radius is tested by distance in a spherical shape
+     *
+     * @param radius amount to add on each axis
+     * @param byDistance true to use a spherical radius, false to use a cuboid
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder receivers(int radius, boolean byDistance);
+
+    /**
+     * Selects all players within a cuboid selection around the sound location, within the
+     * specified bounding box. Allows specifying a different Y size than X and Z If you want a more
+     * cylinder check, see {@link #receivers(int, int, boolean)} If you want a more spherical check,
+     * see {@link #receivers(int, boolean)}
+     *
+     * @param xzRadius amount to add on the x/z axis
+     * @param yRadius amount to add on the y axis
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder receivers(int xzRadius, int yRadius);
+
+    /**
+     * Selects all players within the specified radius around the sound. If byDistance is
+     * false, behavior uses cuboid selection the same as {@link #receivers(int, int)} If byDistance is
+     * true, radius is tested by distance on the y plane and on the x/z plane, in a cylinder shape.
+     *
+     * @param xzRadius amount to add on the x/z axis
+     * @param yRadius amount to add on the y axis
+     * @param byDistance true to use a cylinder shape, false to use cuboid
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder receivers(int xzRadius, int yRadius, boolean byDistance);
+
+    /**
+     * Selects all players within a cuboid selection around the sound location, within the
+     * specified bounding box. If you want a more cylinder check, see {@link #receivers(int, int,
+     * boolean)} If you want a more spherical check, see {@link #receivers(int, boolean)}
+     *
+     * @param xRadius amount to add on the x axis
+     * @param yRadius amount to add on the y axis
+     * @param zRadius amount to add on the z axis
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder receivers(int xRadius, int yRadius, int zRadius);
+
+    /**
+     * @return Location of where the sound will play
+     */
+    @Nullable
+    Location location();
+
+    /**
+     * Sets the location of where to play the sound
+     *
+     * @param location The location of the sound
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder location(@NotNull Location location);
+
+    /**
+     * Sets the location of where to play the sound
+     *
+     * @param world World to play sounds in
+     * @param x X location
+     * @param y Y location
+     * @param z Z location
+     * @return a reference to this object.
+     */
+    @NotNull
+    SoundBuilder location(@NotNull World world, double x, double y, double z);
+
+}
diff --git a/src/main/java/org/bukkit/Bukkit.java b/src/main/java/org/bukkit/Bukkit.java
index fecd7b14d317f55eb1ce7b5c6af9913917971427..3f61254d0daa026e73e322e0ed126532697c26d3 100644
--- a/src/main/java/org/bukkit/Bukkit.java
+++ b/src/main/java/org/bukkit/Bukkit.java
@@ -13,6 +13,8 @@ import java.util.Set;
 import java.util.UUID;
 import java.util.function.Consumer;
 import java.util.logging.Logger;
+
+import io.papermc.paper.sound.SoundBuilder;
 import org.bukkit.Warning.WarningState;
 import org.bukkit.advancement.Advancement;
 import org.bukkit.block.data.BlockData;
@@ -1193,6 +1195,42 @@ public final class Bukkit {
         return server.createMerchant(title);
     }
 
+    /**
+     * Creates an empty SoundBuilder
+     *
+     * @param sound the type of the sound, which will be played
+     * @return a new sound builder
+     */
+    @NotNull
+    public static SoundBuilder createSoundBuilder(@NotNull Sound sound) {
+        return server.createSoundBuilder(sound);
+    }
+
+    /**
+     * Creates an empty SoundBuilder
+     *
+     * @param sound the type of the sound, which will be played
+     * @param volume the volume of the sound, which will be played
+     * @return a new sound builder
+     */
+    @NotNull
+    public static SoundBuilder createSoundBuilder(@NotNull Sound sound, @NotNull Float volume) {
+        return server.createSoundBuilder(sound, volume);
+    }
+
+    /**
+     * Creates an empty SoundBuilder
+     *
+     * @param sound the type of the sound, which will be played
+     * @param volume the volume of the sound, which will be played
+     * @param pitch the pitch of the sound, which will be played
+     * @return a new sound builder
+     */
+    @NotNull
+    public static SoundBuilder createSoundBuilder(@NotNull Sound sound, @NotNull Float volume, @NotNull Float pitch) {
+        return server.createSoundBuilder(sound, volume, pitch);
+    }
+
     /**
      * Gets user-specified limit for number of monsters that can spawn in a
      * chunk.
diff --git a/src/main/java/org/bukkit/Server.java b/src/main/java/org/bukkit/Server.java
index 8e01e1bbb7cfd98b47dbdb3a0e132dafd1413de6..772f9741b852417dbd3861b2e6bd646a3ae2fb03 100644
--- a/src/main/java/org/bukkit/Server.java
+++ b/src/main/java/org/bukkit/Server.java
@@ -13,6 +13,8 @@ import java.util.Set;
 import java.util.UUID;
 import java.util.function.Consumer;
 import java.util.logging.Logger;
+
+import io.papermc.paper.sound.SoundBuilder;
 import org.bukkit.Warning.WarningState;
 import org.bukkit.advancement.Advancement;
 import org.bukkit.block.data.BlockData;
@@ -1002,6 +1004,24 @@ public interface Server extends PluginMessageRecipient {
     @NotNull
     Merchant createMerchant(@Nullable String title);
 
+    /**
+     * Creates an empty SoundBuilder.
+     */
+    @NotNull
+    SoundBuilder createSoundBuilder(@NotNull Sound sound);
+
+    /**
+     * Creates an empty SoundBuilder.
+     */
+    @NotNull
+    SoundBuilder createSoundBuilder(@NotNull Sound sound, Float volume);
+
+    /**
+     * Creates an empty SoundBuilder.
+     */
+    @NotNull
+    SoundBuilder createSoundBuilder(@NotNull Sound sound, Float volume, Float pitch);
+
     /**
      * Gets user-specified limit for number of monsters that can spawn in a
      * chunk.
